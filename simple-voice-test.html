<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç°¡å–®èªéŸ³æ¸¬è©¦</title>
    <style>
        body { font-family: Arial; text-align: center; padding: 50px; }
        button { padding: 20px; font-size: 20px; margin: 10px; }
        #result { margin: 20px; font-size: 18px; }
        .listening { background: red; color: white; }
    </style>
</head>
<body>
    <h1>ç°¡å–®èªéŸ³æ¸¬è©¦</h1>
    <p>3 Ã— 4 = ?</p>

    <button id="startBtn">ğŸ¤ é–‹å§‹éŒ„éŸ³</button>
    <button id="stopBtn" disabled>â¹ï¸ åœæ­¢éŒ„éŸ³</button>

    <div id="result">ç­‰å¾…æ¸¬è©¦...</div>

    <script>
        let recognition = null;
        let isListening = false;

        // æª¢æŸ¥æ”¯æ´
        if ('webkitSpeechRecognition' in window) {
            recognition = new webkitSpeechRecognition();
            recognition.lang = 'zh-TW';
            recognition.continuous = false;
            recognition.interimResults = true;

            recognition.onstart = () => {
                console.log('é–‹å§‹éŒ„éŸ³');
                isListening = true;
                document.getElementById('startBtn').disabled = true;
                document.getElementById('stopBtn').disabled = false;
                document.getElementById('startBtn').className = 'listening';
                document.getElementById('result').textContent = 'æ­£åœ¨è†è½...';
            };

            recognition.onresult = (event) => {
                let transcript = '';
                for (let i = 0; i < event.results.length; i++) {
                    transcript += event.results[i][0].transcript;
                }
                document.getElementById('result').textContent = 'è½åˆ°ï¼š' + transcript;
            };

            recognition.onend = () => {
                console.log('çµæŸéŒ„éŸ³');
                isListening = false;
                document.getElementById('startBtn').disabled = false;
                document.getElementById('stopBtn').disabled = true;
                document.getElementById('startBtn').className = '';
            };

            recognition.onerror = (event) => {
                document.getElementById('result').textContent = 'éŒ¯èª¤ï¼š' + event.error;
                console.error('èªéŸ³è­˜åˆ¥éŒ¯èª¤:', event);
            };

        } else {
            document.getElementById('result').textContent = 'ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è­˜åˆ¥';
        }

        document.getElementById('startBtn').onclick = () => {
            if (recognition && !isListening) {
                try {
                    recognition.start();
                } catch (e) {
                    document.getElementById('result').textContent = 'å•Ÿå‹•å¤±æ•—ï¼š' + e.message;
                }
            }
        };

        document.getElementById('stopBtn').onclick = () => {
            if (recognition && isListening) {
                recognition.stop();
            }
        };
    </script>
</body>
</html>